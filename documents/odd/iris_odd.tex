\documentclass[a4paper, 11pt]{scrartcl}
\usepackage[top = 2.5cm, bottom = 2cm, left = 2.5cm, right = 2.5cm]{geometry}
\usepackage[onehalfspacing]{setspace}
\usepackage{mathtools}
\usepackage{fontspec}
\usepackage[english]{babel}
\usepackage{hyperref}
\hypersetup{
	colorlinks = true,
	linkcolor  = black,
	citecolor  = blue,
	urlcolor   = blue
}

\usepackage{acronym}
\usepackage{enumerate}
\usepackage{tabularx}
\usepackage{booktabs}
\usepackage{multirow}

\usepackage{csquotes}
\usepackage[backend = biber, style = apa]{biblatex}
\addbibresource{../iris_literature.bib}

\setlength{\parskip}{1em}

\title{IRIS - ODD Protocol}
\author{}
\date{\today}

\begin{document}

\maketitle
\tableofcontents

\newpage
\listoffigures
\listoftables

\section*{List of Acronyms}
\begin{acronym}
\acro{GCM}{Global Change Model}
\acro{GERICS}{The Climate Service Center Germany}
\acro{IRIS}{Ixodes RIcinus Simulator}
\acro{ODD}{Overview, Design Concepts and Details}
\acro{RCM}{Regional Change Model}
\end{acronym}


\newpage
\section{Overview}
This model description follows the Overview, Design concepts and Details (ODD) protocol. ODD is a standard format to systematically
describe models in a comprehensive and transparent way aiming to allow for model replication ~\parencite{Grimm.2010, Grimm.2020}.

IRIS (Ixodes RIcinus Simulator) is a cohort-based and spatially-explicit population model to simulate local dynamics of \textit{Ixodes
ricinus} ticks under changing climate parameters. It simulates the spatial and temporal development and questing activity of ticks of
different life stages over a year. The population dynamic is driven by climate predictors such as temperature and humidity and by
ecological predictors such as habitat suitability. The IRIS model is to be expanded in the future to include a Lyme disease dynamic.

This model has been developed within project `Infectious diseases and allergies` of the HI-CAM initiative
~\footnote{\url{https://www.helmholtz-klima.de/en/adaptation/project-infectious-diseases-and-allergies}}.


\subsection{Purpose}
The overall purpose of the IRIS model is to understand the impact of changing climate on local tick and borrelian dynamics. As
ticks are highly relevant vectors of Lyme disease, it is important to gain a better understanding of their future climate-dependent
dynamics.


\subsection{Entities, state variables, and scales}
The model is composed of the following entities: (a) sub populations of \textit{Ixodes ricinus} ticks belonging to a cohort and (b) grid
cells forming an idealised model landscape. Each cohort represents a tick life cycle stage together with a behavioural state. Three tick
life cycle stages are possible: (1) larvae, (2) nymphs and (3) adults. Furthermore, four behavioural states are possible: (i) questing,
(ii) inactive, (iii) fed and (iv) late fed. Hence, in total there are 12 tick cohorts present in the model. Grid cells serve as habitat for
tick sub populations. Three different idealised habitat types exist in the model: (a) forest, (b) ecotone and (c) meadow.

The spatial scale of the model corresponds to a local region of approximately $14400 \mathrm{m}^{2}$ ($= 0.0144 \mathrm{km}^{2}$) in reality. The model
idealised landscape consists of $12 \times 12 = 144$ grid cells. A grid cell corresponds to an area of $10 \mathrm{m} \times 10 \mathrm{m} = 100
\mathrm{m}^{2}$. This grid size was chosen because tick densities are usually expressed in numbers per $100 \mathrm{m}^{2}$
~\parencite[see e.g.][Table 2]{Boehnke.2015}. This is because the standard method of collecting host-seeking ticks (called flagging) is
typically done over a sampling area of $100 \mathrm{m}^{2}$ ~\parencite{Brugger.2016, Schulz.2014}.

The IRIS model runs with daily time steps. One model run simulates one year, from January 1 to December 31, in reality. On this time
scale, we are able to capture the local population dynamics of ticks well. Since our model is cohort-based we are looking at averaged
behaviour which harmonises well with daily time steps. Required input data such as temperature and humidity is  available on a daily
basis ~\parencite(DWD.2020, GERICS.2020). Furthermore, daily time steps are also computationally feasible.

% Insert figure with graphical summary with entities and state variables here


\subsection{Process overview and scheduling}
The IRIS model is executed in daily discrete time steps. Since the model always simulates one year, 365 days are usually simulated, unless
a year is a leap year. In a leap year 366 days are simulated including 29 February. At each time step, the the following model processes
are executed and the state-variables are updated:

\begin{enumerate}
	\item Development to the next life cycle stage
	\item Freezing
	\item Desiccation
	\item Feeding: Attaching of ticks to host animals and translocation
	\item Weather
	\item Activity
\end{enumerate}

Since a single simulation run always covers exactly one year, the multi-year life cycle of the modelled ticks is captured indirectly.
This is done by assigning a certain number of ticks at the beginning of a simulation run, so that each life cycle stage is represented in
the model through its respective cohort.


\newpage
\section{Design}


\subsection{Basic principles}
IRIS is a Spatially explicit stochastic cohort-based tick population model. It was implemented in Java using version 2.3.0 of the Artemis-odb Entity-Component-System framework
\footnote{\url{https://github.com/junkdog/artemis-odb}}.

\subsection{Stochasticity}
To determine random numbers we use the seedable random number generator ``Mersenne-Twister'' provided by Apache Commons Math library
(version 3.6.1.). In addition we implemented a method roundRandom() to allow processes that statistically affect less than
a single tick to still happen.
% tbc. needs further explanation.
% insert source code of roundRandom() here


\newpage
\section{Details}

\subsection{Globals}

\subsection{Initialisation}


\subsubsection{Adjusting the initial number of larvae using beech mast fructification data}\label{initial_larvae_with_beech_mast}
If data is available the model is able to use beech mast fructification data of the European beech \textit{Fagus sylvatica} to adjust the initial number of larvae at the beginning
of a simulation run. This reason for this adjustment can be explained as follows: Small rodents serve as host animals especially for \textit{Ixodes ricinus} larvae~\parencite{Cayol
.2017}. A higher density of small rodents in a given year causes an increase in the population of larvae and nymphs in the following year~\parencite{Brugger.2018}. Data on
beech mast can be used to estimate rodent populations, because a year with high mast production leads to an increase in the rodent population in the following year due to
higher food supply~\parencite{Clement.2009}. Hence, we assume that the initial number of larvae at the beginning of a simulation run of a given year is influenced by the beech
mast two years before.

The type of beech mast is divided into four classes and given as an index. Based on this fructification index, the model adjusts the initial number of larvae at the beginning of
a simulation run. The default number of initial larvae is reduced if when the second year before the simulated year is not a mast year with full fructification. The strength of
the reduction depends on the type of beech mast, i.e.\ the fructification index. Table~\ref{tab:fructification_adjustment} gives an overview over the adjustment values.
Information on the beech mast input data can be found in Section~\ref{beech_mast_data}.

\begin{table}[h!]
\caption{Adjustment of initial number of larvae based on the fructification index}
\label{tab:fructification_adjustment}
\begin{tabularx}{\textwidth}{@{}lll@{}}
\toprule
\textbf{Fructification index} & \textbf{Description}    & \textbf{Adjustment Value}  	\\
\midrule
1				 	  		  & absent fructification 	& 	0.25	 			\\
2 				 	  		  & scarce fructification	&	0.5					\\
3 					  		  & common fructification	& 	0.75				\\
4					 		  & full fructification 	& 	1.0					\\
\bottomrule
\end{tabularx}
\end{table}




\subsection{Input data}
IRIS uses observed weather and simulated climate data and optionally data on beech mast as input data. In detail, the model requires the following input data on a daily basis:
\begin{itemize}
\item Daily mean near-surface air temperature [Degree Celsius]
\item Daily Maximum Near-Surface Air Temperature [Degree Celsius]
\item Daily Maximum Near-Surface Air Temperature [Degree Celsius]
\item Daily near surface relative humidity [\%]
\end{itemize}

An overview over the input parameters can be found in Table ~\ref{input_parameters}.


\subsubsection{Observed weather data}
Weather data from DWD (*.csv file)
%tbc.

\subsubsection{Climate simulation data}
Climate simulation data was provided by The Climate Service Center Germany (GERICS). A total of 15 combinations of Global Change Models
(GCMs) and Regional Chance Models (RCMs) were provided for the RCP8.5 scenario, i.e.\ the scenario that exceeds 4K global warming
(see Table ~\ref{tab:climate_models} for an overview).

Bias-adjusted EURO-CORDEX simulations were provided for the following parameters:
\begin{itemize}
\item Bias Adjusted Near-Surface Air Temperature (tas, [K])
\item Bias Adjusted Daily Maximum Near-Surface Air Temperature (tasmax, [K])
\item Bias Adjusted Daily Minimum Near-Surface Air Temperature (tasmin, [K])
\end{itemize}

Homogenised EURO-CORDEX simulations were provided for the following parameter:
\begin{itemize}
\item Near-Surface Relative Humidity (hurs, [\%])
\end{itemize}
% noch etwas mehr erl√§utern (EURO-CORDEX, bias-adjusted, homogenised, etc., Warum so viele Modelle)


\begin{table}[h!]
\caption{GCM-RCM combinations for the RCP8.5 scenario}
\label{tab:climate_models}
\begin{tabularx}{\textwidth}{@{}ll@{}}
\toprule
\textbf{Driving GCM and realisation}  & \textbf{Downscaling RCM} 	\\
\midrule
CanESM2; r1i1p1 				 	  & CCLM4-8-17; v1  		 	\\
CanESM2; r1i1p1 				 	  & REMO2015; v1 				\\
HadGEM2-ES; r1i1p1 					  & Aladin63; v1 				\\
HadGEM2-ES; r1i1p1 					  & HadREM3; v1 				\\
HadGEM2-ES; r1i1p1 					  & HIRHAM5; v2 				\\
HadGEM2-ES; r1i1p1 					  & RACMO22E; v2 				\\
HadGEM2-ES; r1i1p1 					  & RCA4; v1 					\\
HadGEM2-ES; r1i1p1 					  & RegCM4-6; v1 				\\
HadGEM2-ES; r1i1p1 					  & REMO2015; v1 				\\
HadGEM2-ES; r1i1p1 					  & WRF381P; v1 				\\
IPSL-CM5A-MR; r1i1p1 				  & RACMO22E; v1 				\\
IPSL-CM5A-MR; r1i1p1 				  & RCA4; v1 					\\
IPSL-CM5A-MR; r1i1p1 				  & WRF381P; v1 				\\
MPI-ESM-LR; r3i1p1 					  & RCA4; v1 					\\
MPI-ESM-LR; r3i1p1 					  & REMO2015; v1 				\\
\bottomrule
\end{tabularx}
\end{table}

% (Tests und Validierung haupts√§chlich mit MPI-ESM-LR; r3i1p1, REMO2015; v1)
% erkl√§ren: als NetCDF file f√ºr Ausschnitt ca. Deutschland bekommen --> *.csv file (Rausziehen der Wetterzeitreihe mittels Skript)
% Umrechnung von K in Celsius

\subsubsection{Beech mast fructification data}\label{beech_mast_data}
IRIS is able to use beech mast fructification data of the European beech \textit{Fagus sylvatica}. This data can be used to adjust the initial number of larvae
(for details see Section~\ref{initial_larvae_with_beech_mast}). Beech mast fructification data is given as an annual index. For the validation of the model we have used the values
from~\cite{Brugger.2018}. A larger data set with fructification data between 1954 an 2016 is available from~\cite{Konnert.2016}.


\begin{table}[h!]
\caption{Input parameters}
\label{input_parameters}
\begin{tabularx}{\textwidth}{llll}
\toprule
\textbf{Parameter} & \textbf{Symbol} & \textbf{Type}     & \textbf{Description}       \\
\midrule
meanTemperature    & $t_{mean}$      & double            & Daily mean temperature     \\
minTemperature     & $t_{\min}$      & double            & Daily max temperature      \\
maxTemperature     & $t_{\max}$      & double            & Daily min temperature      \\
humidity           & $h$             & double            & Daily humidity             \\
\midrule
fructificationIndex & $f$            & int               & Fructification index       \\
\bottomrule
\end{tabularx}
\end{table}


\newpage
\subsection{Submodels}

\subsubsection{Development}
This sub model is implemented in the method \textit{development()} in the class \textit{TickLifeCycle}.

The development from one life cycle stage to the next takes place over specific periods of time. The development period begins at the beginning of July and ends either in early
or mid-October, depending on the life cycle stage. Since only fed ticks can develop to the next life cycle stage, their number is subtracted from the respective cohort with
behavioural state 'fed' and added to the cohort of the next life  cycle stage with behavioural state 'inactive'. It is assumed that the number of ticks developing to the next
life cycle stage at each time step is calculated in the following way so that all ticks will have developed at the end of the development period:

\begin{equation}
n_{\text{developing}}(t) = \text{roundRandom}(\frac{n_{fed}(t)}{t_{\text{end} - t_{\text{current}}}})
\end{equation}

The values of the start and end times of the development period are implemented as constants. Table ~\ref{tab:development_parameters} gives an overview over the
development parameters.

\begin{table}[h!]
\caption{Time period of development to next life cycle stage}
\label{tab:development_parameters}
\begin{tabularx}{\textwidth}{lclcl}
\toprule
\textbf{Time period} 	& \textbf{Time step} & \textbf{Parameter Name}							& \textbf{Type}    & \textbf{Reference} \\
\midrule
Early July   			& 181   			 & \tiny{BEGIN\_OF\_DEVELOPMENT}					& int      & ~\cite{tba}   		\\
Mid-October     		& 289      			 & \tiny{END\_OF\_DEVELOPMENT\_LARVAE\_TO\_NYMPHS}	& int      & ~\cite{tba}      	\\
Early October    		& 274    			 & \tiny{END\_OF\_DEVELOPMENT\_NYMPHS\_TO\_ADULTS}	& int      & ~\cite{tba}     	\\
Mid-October     		& 289      			 & \tiny{END\_OF\_DEVELOPMENT\_ADULTS\_TO\_LARVAE}	& int      & ~\cite{tba}        \\
\bottomrule
\end{tabularx}
\end{table}

The oviposition of adult ticks is not explicitly modelled. It is assumed that adult ticks become new larvae.
% tba. needs further explanation.


\subsubsection{Desiccation}
This sub model controls the desiccation of ticks. It is implemented in the method \textit{desiccation()} in the class \textit{TickLifeCycle}.

In general ticks need at least 80 \% relative humidity in their local environment to survive ~\parencite{Medlock.2013, Gray.2016, Hauser.2018}. When the relative humidity falls
below this level off-host ticks start to dry out and will eventually die unless the relative humidity rises again. Survival at lower relative humidity is possible but also
requires lower temperatures ~\parencite{Ostfeld.2015}.

At each time step the sub model checks whether the relative humidity in a grid cell is below 80 \% on days with a mean temperature $t_{mean} \geq 15$. In this case, a proportion of
all questing ticks that are in such a grid cell will desiccate. The exact desiccation rate depends on the habitat type of the grid cell. With this, we assume that more
ticks dry out in a meadow than in the forest. The number of desiccated ticks is subtracted from their respective cohort. Table ~\ref{tab:desiccation_parameters} gives an
overview over the habitat dependent desiccation rates and threshold values.

\begin{table}[h!]
\caption{Habitat dependent desiccation rates and threshold values}
\label{tab:desiccation_parameters}
\begin{tabular}{@{}llcl@{}}
\toprule
\textbf{Parameter}											& \textbf{Habitat Type}  & \textbf{Value}	& \textbf{Reference}  	\\
\midrule
\tiny{DEATH\_THRESHOLD\_DESICCATION\_MINIMAL\_HUMIDITY}		& -    			 		 &   80.0    		&  ~\cite{Medlock.2013, Gray.2016, Hauser.2018}	\\
\tiny{DEATH\_THRESHOLD\_DESICCATION\_MINIMAL\_MEAN\_TEMP}	& -    			 		 &   15.0    		&  ~\cite{Ostfeld.2015}						\\
\multirow{3}{*}{\tiny{DESICCATION\_RATE}}  					& Forest       			 &   0.02   		&            		    \\
				 											& Ecotone 				 &   0.05    		&					    \\
				 											& Meadow    			 &   0.10    		&  						\\
\bottomrule
\end{tabular}
\end{table}


\subsubsection{Freezing}
The sub model `freezing' is responsible for modeling the effect of extreme cold on ticks. It is implemented in the method \textit{freezing()} in the class
\textit{TickLifeCycle}.

Ixodes ricinus ticks are quite cold resistant when exposed to low temperatures ~\parencite{Gray.2009}. However, it can become critical for ticks when exposed to extreme cold with
temperatures lower than approximately minus 15 degrees Celsius ~\parencite{Ostfeld.2015}. Especially without protective snow cover ticks can die of freezing under these
conditions ~\parencite{Jore.2014}.

At each time step the sub model checks whether the minimum temperature $t_{\min}$ is below a threshold value of minus 18.9 degree Celsius. If that is the case, some of the
ticks are considered dead and are hence removed from the modelled population. Table ~\ref{tab:freezing_parameters} contains the parameters that belong to the freezing sub model.

\begin{table}[h!]
\caption{Parameters of the freezing sub model}
\label{tab:freezing_parameters}
\begin{tabular}{@{}lcl@{}}
\toprule
\textbf{Parameter}											  	& \textbf{Value}	& \textbf{Reference}  		\\
\midrule
\tiny{FREEZING\_RATE}		    			 		 			&   0.03    		&  							\\
\tiny{DEATH\_THRESHOLD\_FREEZING\_MIN\_TEMP\_WITHOUT\_SNOW}	   	&   -18.9    		&  ~\cite{Gray.2009}		\\
\bottomrule
\end{tabular}
\end{table}


\subsubsection{Activity}
The sub model `activity' is responsible for controlling the activity status of the modeled tick population. It is implemented in the method \textit{process()} in the class
\textit{Activity}. Activity in context of this model means that ticks are either questing (also known as host-seeking) or inactive unless they are engorged. The change from one
activity state to the other depends on the microclimate to which the tick is exposed. When temperatures and relative humidity are suitable, unfed ticks begin to
quest~\parencite{Perret.2000}. They do this by climbing up the vegetation to find a host. To prevent desiccation, ticks must return to the ground,
where the relative humidity is greater than the relative humidity at host-seeking height due to the ground moisture~\parencite{Randolph.2004}.

At each time step, the activity sub model checks the prevailing conditions in terms of temperature and relative humidity. When microclimatic conditions are suitable for
questing, i.e.\ when temperature and humidity are within certain ranges (see Table~\ref{tab:activation_parameters}), the number of questing ticks increases with a specific
activation rate and the number of inactive ticks is reduced accordingly. Under suboptimal but possible conditions, only a very small proportion of ticks will quest. In this
case the number of questing ticks increases at a much lower activation rate. But if the microclimatic conditions are unsuitable for host-seeking, the ticks will retreat to the
ground to rehydrate with the default activation rate. The ticks are then classified as inactive. Table ~\ref{tab:activation_parameters} contains an overview over the activation
parameters values belonging to the activity sub model.

\begin{table}[h!]
\caption{Parameters of the activity sub model}
\label{tab:activation_parameters}
\begin{tabular}{@{}lcll@{}}
\toprule
\textbf{Parameter}	& \textbf{Value}	& \textbf{Type}	& \textbf{Reference} \\
\midrule
\tiny{ACTIVATION\_THRESHOLD\_NECESSARY\_MAXIMAL\_MAX\_TEMP}	& 35.0  & float	& ~\cite{Gray.2016, MacLeod.1935} \\
\tiny{ACTIVATION\_THRESHOLD\_NECESSARY\_MINIMAL\_MAX\_TEMP}	&  1.9  & float	& ~\cite{Perret.2000}  		\\
\tiny{ACTIVATION\_THRESHOLD\_NECESSARY\_MINIMAL\_MEAN\_TEMP}&  1.2 	& float	& ~\cite{Perret.2000}		\\
\tiny{ACTIVATION\_THRESHOLD\_NECESSARY\_MINIMAL\_HUMIDITY}	& 45.0  & float	& ~\cite{Greenfield.2011}	\\
\tiny{ACTIVATION\_THRESHOLD\_OPTIMAL\_MINIMAL\_MAX\_TEMP}	& 10.5 	& float	& ~\cite{Perret.2000}		\\
\tiny{ACTIVATION\_THRESHOLD\_OPTIMAL\_MAXIMAL\_MAX\_TEMP}	& 26.0  & float	& ~\cite{Greenfield.2011}	\\
\tiny{ACTIVATION\_THRESHOLD\_OPTIMAL\_MINIMAL\_MEAN\_TEMP}	&  6.0  & float & ~\cite{Gilbert.2014}		\\
\tiny{ACTIVATION\_THRESHOLD\_OPTIMAL\_MAXIMAL\_MEAN\_TEMP}	& 20.0 	& float	& ~\cite{Kubiak.2006}		\\
\midrule
\tiny{OPTIMAL\_SHARE\_OF\_ACTIVATION\_RATE}					&  1.0  & float	&  		\\
\tiny{SUBOPTIMAL\_SHARE\_OF\_ACTIVATION\_RATE}				&  0.05	& float	&  		\\
activationRate	   											&  0.02 & float	& determined by optimisation  \\
\bottomrule
\end{tabular}
\end{table}


\subsubsection{Feeding}


\subsubsection{Micro climate}

\begin{table}[h!]
\caption{Adjustment values to adapt weather and climate data to the real conditions at the ground where ticks live}
\label{tab:micro_climate_adjustments}
\begin{tabular}{@{}lllrll@{}}
\toprule
\textbf{Parameter}					& \textbf{Season} 					& \textbf{Habitat Type}  & \textbf{Value}  	& \textbf{Unit} & \textbf{Reference}  	\\
\midrule
\multirow{3}{*}{Temperature} 		& \multirow{3}{*}{Autumn \& Spring} & Pasture 				 &   0.0   			&   Degree Celsius	&            		    \\
									&									& Ecotone 				 &   -1.0 	  		&   Degree Celsius &	    				\\
									&					 				& Wood    				 &   -2.0   		&   Degree Celsius &	    				\\
\midrule
\multirow{3}{*}{Temperature} 		& \multirow{3}{*}{Summer}        	& Pasture 				 &   0.0    		&	Degree Celsius	&          				\\
									&				 	 				& Ecotone 				 &  -2.0    		&  	Degree Celsius	& ~\cite{Geiger.1995}  	\\
									&				 	 				& Wood	   				 &  -4.0    		&  	Degree Celsius	& ~\cite{Bonan.2016}   	\\
\midrule
\multirow{3}{*}{Relative Humidity}  & \multirow{3}{*}{All seasons}      & Pasture 				 &   12   			&  	\%			&            		    \\
									&				 					& Ecotone 				 &   18    			&   \%    		&					    \\
									&				 					& Wood    				 &   24    			&  	\%			& ~\cite{Boehnke.2017} 	\\
\bottomrule
\end{tabular}
\end{table}



\newpage
\printbibliography[heading = bibintoc, title = {Bibliography}]

\end{document}
